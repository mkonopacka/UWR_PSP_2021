"0","# Zebranie statystyk"
"0","income_stats <- "
"0","  income %>%"
"0","  mutate(val = Income) %>%"
"0","  summarise(mean = mean(val), median = median(val),"
"0","                        Q1 = quantile(val, 0.25), Q3 = quantile(val, 0.75), "
"0","                        out_l = Q1 - 1.5*(Q3-Q1),out_r = Q3 + 1.5*(Q3-Q1),"
"0","                        min = min(val), max = max(val),"
"0","                        sd = sd(val), variance = var(val),"
"0","                        CV = sd(val)/mean(val)) "
"0",""
"0","# Z podziałem na płeć"
"0","income_stats_gender <- "
"0","  income %>%"
"0","  mutate(val = Income) %>%"
"0","  group_by(Gender) %>%"
"0","  summarise(mean = mean(val), median = median(val),"
"0","                        Q1 = quantile(val, 0.25), Q3 = quantile(val, 0.75), "
"0","                        out_l = Q1 - 1.5*(Q3-Q1),out_r = Q3 + 1.5*(Q3-Q1),"
"0","                        min = min(val), max = max(val),"
"0","                        sd = sd(val), variance = var(val),"
"0","                        CV = sd(val)/mean(val)) "
"0",""
"0","plot2 <-"
"0","  ggplot(income_stats) +"
"0","  geom_histogram(data = income %>% mutate(val = Income), aes(x = val), bins = 15, alpha = 0.4) +"
"0","  theme_bw() +"
"0","  labs(x = '', y = '', title = 'Histogram zarobków', subtitle = 'Czerwoną linią zaznaczono średnie, liniami przerywanymi kwartyle, a niebieskimi progi obserwacji odstających') +"
"0","  theme(plot.title.position = ""plot"", plot.caption.position =  ""plot"", legend.position = ""none"") +"
"0","  geom_vline(aes(xintercept = mean), col = 'red') +"
"0","  geom_vline(aes(xintercept = Q1), linetype = 'dashed') +"
"0","  geom_vline(aes(xintercept = median), linetype = 'dashed') +"
"0","  geom_vline(aes(xintercept = Q3), linetype = 'dashed') +"
"0","  geom_vline(aes(xintercept = out_l), col = 'blue') +"
"0","  geom_vline(aes(xintercept = out_r), col = 'blue') "
"0",""
"0","plot2"
