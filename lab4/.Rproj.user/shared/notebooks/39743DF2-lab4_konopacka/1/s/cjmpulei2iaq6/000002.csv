"0","glob_iter = 200"
"0","# Funkcja zwracające prawy przedziały ufności oparte na: 1.rozkładzie normalnym z szacowaniem sigma 2.rozkładzie Studenta (X - próba)"
"0","interval1 <- function(X, opt = 1, lvl = 0.95){"
"0","  alpha <- 1 - lvl"
"0","  X_ <- mean(X)"
"0","  n <- length(X)"
"0","  s <- sd(X)"
"0","  if (opt == 1){a <- qnorm(1 - alpha/2)}"
"0","  if (opt == 2){a <- qt(1 - alpha/2, n-1)}"
"0","  expr <- a*s/sqrt(n)"
"0","  return (c(X_ - expr, X_ + expr))"
"0","}"
"0",""
"0","# Funkcja losująca próbę rozmiaru n z rozkładu normalnego N(mu,si) iter razy i sprawdzająca jak często prawdziwe mu zawiera się w przedziale ufności; Szacowanie przez `opt`: 1 - rozkład normalny 2 - rozkład Studenta"
"0","experiment1 <- function(n = 10, opt = 1, iter = glob_iter, lvl = 0.95, mu = 0, si = 1){"
"0","  inside <- 0"
"0","  for (i in 1:iter){"
"0","    X <- rnorm(n, mu, si)"
"0","    interval <- interval1(X, opt, lvl)"
"0","    if (between(mu, interval[1], interval[2])){inside <- inside + 1}"
"0","  }"
"0","  return(data.frame("
"0","    mu = mu,"
"0","    si = si,"
"0","    n = n,"
"0","    opt = opt,"
"0","    inside = inside/iter,"
"0","    lvl = lvl,"
"0","    iter = iter"
"0","  ))"
"0","}"
